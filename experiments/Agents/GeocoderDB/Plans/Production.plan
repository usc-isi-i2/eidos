PLAN Production
{
  INPUT:   text address
  OUTPUT:   stream Production_output

  BODY
  {
    /* Generated by PlanGenerator 2.0.00 - 10/17/2008 13:39:56 PDT*/
    /* Plan Type: Main Plan, Batch*/
    
    /**********  Initialization **********/
    test_makexmlnode2("AgentInputValues",("address",address,"") : agentInputValues)
    test_initializeagentexecution4(agentInputValues : agentInputStream,agentMetadataStream)
    
    /**********  Retrieve Request Bindings **********/
    test_makeandstorerequestbindings("$Entry",("EntryConn1"),agentInputStream : agentInputStream2,err_makeandstorebindings_Entry)
    test_retrieverequestbindings(("$Entry.EntryConn1","Home.Connector1"),agentInputStream2 : err_retrievebindings,(Entry_EntryConn1_bindings,Home_Connector1_bindings))
    test_unionvar((err_makeandstorebindings_Entry,err_retrievebindings) : err_unfinished_Entry)
    test_dbwriteerror(err_unfinished_Entry : err_Entry)
    
    /**********  Request Entry_EntryConn1  **********/
    test_fetch("$Entry.EntryConn1",Entry_EntryConn1_bindings : Entry_EntryConn1_page_to_Home,err_fetch_Entry_EntryConn1)
    test_dbwriteerror(err_fetch_Entry_EntryConn1 : err_Entry_EntryConn1)
    
    /**********  Wrapper Home  **********/
    test_makeandstorerequestbindings("Home",("Connector1"),Entry_EntryConn1_page_to_Home : Home_processedData,err_makeandstorebindings_Home)
    test_finishrequest(Home_processedData,"success" : Home_finishedData,err_validate_Home)
    test_unionvar((err_makeandstorebindings_Home) : err_unfinished_Home)
    test_dbwriteerror(err_unfinished_Home : err_Home)
    
    /**********  Request Home_Connector1  **********/
    test_fetch("Home.Connector1",Home_Connector1_bindings : Home_Connector1_page_to_Detail1,err_fetch_Home_Connector1)
    test_dbwriteerror(err_fetch_Home_Connector1 : err_Home_Connector1)
    
    /**********  Wrapper Detail1  **********/
    test_extract("Detail1",Home_Connector1_page_to_Detail1 : Detail1_unvalidated_data,err_extract_Detail1)
    test_validate2(Detail1_unvalidated_data : Detail1_data,unused_1_Detail1)
    test_flatten2(Detail1_data,"union" : Detail1_flattened_data,err_flatten_Detail1)
    test_dbwritedata3("geocoderdb_Detail1","*(8000)",Detail1_flattened_data : Detail1_writtenData,err_validate_Detail1,err_writedata_Detail1)
    test_unionvar((err_extract_Detail1,err_flatten_Detail1,err_writedata_Detail1) : err_unfinished_Detail1)
    test_dbwriteerror(err_unfinished_Detail1 : err_Detail1)
    
    /**********  Error Handling   **********/
    test_unionvar((err_Entry,err_Entry_EntryConn1,err_Home_Connector1,err_Home,err_Detail1) : errors)
    test_unionvar((err_validate_Home,err_validate_Detail1) : validation_errors)
    
    /**********  Convert data to XML   **********/
    test_generateplanoutput(agentMetadataStream : agentMetadataStream_xml)
    test_generateplanoutput(agentInputStream : agentInputStream_xml)
    test_generateplanoutput(errors : errors_xml)
    test_generateplanoutput(validation_errors : validation_errors_xml)
    
    /**********  Combine output streams  **********/
    test_unionvar((agentInputStream_xml,agentMetadataStream_xml,errors_xml,validation_errors_xml) : Production_output)
  }
}